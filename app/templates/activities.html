{% extends "base.html" %}

{% block title %}Activity Log - Strava Metrics Hub{% endblock %}

{% block head %}
  <!-- DataTables CSS -->
  <link href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container pb-5">
  <div class="card shadow-sm p-4 border-0">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold mb-0">Training Log</h2>
      <span class="badge bg-secondary">{{ activities|length }} Activities</span>
    </div>

    <div class="table-responsive">
      <table id="activityTable" class="table table-hover align-middle" style="width:100%">
        <thead class="table-light">
          <tr>
            <th>Date</th>
            <th>Name</th>
            <th>Type</th>
            <th>Dist (km)</th>
            <th>Time</th>
            <th>Elev (m)</th>
            <th>Avg HR</th>
          </tr>
        </thead>
        <tbody>
          {% for activity in activities %}
          <tr>
            <td class="text-nowrap">{{ activity.start_date.strftime('%Y-%m-%d') }}</td>
            <td class="fw-bold">{{ activity.name }}</td>
            <td>
              {% if activity.type == 'Run' %}
                <span class="badge bg-orange">Run</span>
              {% elif activity.type == 'Ride' %}
                <span class="badge bg-primary">Ride</span>
              {% else %}
                <span class="badge bg-secondary">{{ activity.type }}</span>
              {% endif %}
            </td>
            <td>{{ (activity.distance / 1000) | round(2) }}</td>
            <td>{{ (activity.moving_time / 60) | int }} min</td>
            <td>{{ activity.total_elevation_gain }}</td>
            <td>
              {% if activity.average_heartrate %}
                {{ activity.average_heartrate | int }} <span class="text-muted small">bpm</span>
              {% else %}
                <span class="text-muted">-</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
  <!-- DataTables JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

  <script>
    $(document).ready(function () {
      $('#activityTable').DataTable({
        "order": [[ 0, "desc" ]],
        "pageLength": 25,
        "language": {
          "search": "Filter activities:"
        }
      });
    });
  </script>
{% endblock %}
